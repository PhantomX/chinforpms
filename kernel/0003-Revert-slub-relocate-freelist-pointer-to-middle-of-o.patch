From dde3c3b49d14a5b7381e5955405a1aeee81990d6 Mon Sep 17 00:00:00 2001
From: Fedora Kernel Team <kernel-team@fedoraproject.org>
Date: Wed, 15 Jul 2020 14:58:02 -0300
Subject: [PATCH 3/3] Revert: slub: relocate freelist pointer to middle of
 object

This reverts 3202fa62fb43087387c65bfa9c100feffac74aa6
---
 mm/slub.c | 7 -------
 1 file changed, 7 deletions(-)

diff --git a/mm/slub.c b/mm/slub.c
index 6ae79be..d3c83bc 100644
--- a/mm/slub.c
+++ b/mm/slub.c
@@ -3609,13 +3609,6 @@ static int calculate_sizes(struct kmem_cache *s, int forced_order)
 		 */
 		s->offset = size;
 		size += sizeof(void *);
-	} else if (size > sizeof(void *)) {
-		/*
-		 * Store freelist pointer near middle of object to keep
-		 * it away from the edges of the object to avoid small
-		 * sized over/underflows from neighboring allocations.
-		 */
-		s->offset = ALIGN(size / 2, sizeof(void *));
 	}
 
 #ifdef CONFIG_SLUB_DEBUG
-- 
2.26.2

