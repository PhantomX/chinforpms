From a92872388a7bbe0890db6452d9541eb188e52de9 Mon Sep 17 00:00:00 2001
From: Phantom X <PhantomX@users.noreply.github.com>
Date: Wed, 30 Mar 2022 20:03:17 -0300
Subject: [PATCH] gcc 12 build fix

---
 externals/sirit/src/stream.h                            | 1 +
 src/common/common_types.h                               | 6 ++++++
 src/common/settings.cpp                                 | 6 ++++++
 src/core/file_sys/content_archive.cpp                   | 6 ++++++
 src/core/hle/service/sockets/bsd.cpp                    | 6 ++++++
 src/input_common/drivers/udp_client.cpp                 | 1 +
 src/shader_recompiler/frontend/maxwell/control_flow.cpp | 6 ++++++
 src/shader_recompiler/ir_opt/verification_pass.cpp      | 6 ++++++
 src/video_core/macro/macro_jit_x64.cpp                  | 6 ++++++
 9 files changed, 44 insertions(+)

diff --git a/externals/sirit/src/stream.h b/externals/sirit/src/stream.h
index ee3e7b8..a145f76 100755
--- a/externals/sirit/src/stream.h
+++ b/externals/sirit/src/stream.h
@@ -13,6 +13,7 @@
 #include <functional>
 #include <string_view>
 #include <unordered_map>
+#include <utility>
 #include <variant>
 #include <vector>
 
diff --git a/src/common/common_types.h b/src/common/common_types.h
index 99bffc4..1f3244a 100755
--- a/src/common/common_types.h
+++ b/src/common/common_types.h
@@ -27,6 +27,12 @@
 #include <array>
 #include <cstdint>
 
+#ifdef __GNUC__
+#ifndef __clang__
+#pragma GCC diagnostic ignored "-Warray-bounds"
+#endif
+#endif
+
 using u8 = std::uint8_t;   ///< 8-bit unsigned byte
 using u16 = std::uint16_t; ///< 16-bit unsigned short
 using u32 = std::uint32_t; ///< 32-bit unsigned word
diff --git a/src/common/settings.cpp b/src/common/settings.cpp
index 877e0fa..c360a5d 100755
--- a/src/common/settings.cpp
+++ b/src/common/settings.cpp
@@ -9,6 +9,12 @@
 #include "common/logging/log.h"
 #include "common/settings.h"
 
+#ifdef __GNUC__
+#ifndef __clang__
+#pragma GCC diagnostic ignored "-Wmaybe-uninitialized"
+#endif
+#endif
+
 namespace Settings {
 
 Values values = {};
diff --git a/src/core/file_sys/content_archive.cpp b/src/core/file_sys/content_archive.cpp
index 7019a7a..80d643a 100755
--- a/src/core/file_sys/content_archive.cpp
+++ b/src/core/file_sys/content_archive.cpp
@@ -17,6 +17,12 @@
 #include "core/file_sys/vfs_offset.h"
 #include "core/loader/loader.h"
 
+#ifdef __GNUC__
+#ifndef __clang__
+#pragma GCC diagnostic ignored "-Wmaybe-uninitialized"
+#endif
+#endif
+
 namespace FileSys {
 
 // Media offsets in headers are stored divided by 512. Mult. by this to get real offset.
diff --git a/src/core/hle/service/sockets/bsd.cpp b/src/core/hle/service/sockets/bsd.cpp
index f832726..8e6b60a 100755
--- a/src/core/hle/service/sockets/bsd.cpp
+++ b/src/core/hle/service/sockets/bsd.cpp
@@ -18,6 +18,12 @@
 #include "core/network/network.h"
 #include "core/network/sockets.h"
 
+#ifdef __GNUC__
+#ifndef __clang__
+#pragma GCC diagnostic ignored "-Wmaybe-uninitialized"
+#endif
+#endif
+
 namespace Service::Sockets {
 
 namespace {
diff --git a/src/input_common/drivers/udp_client.cpp b/src/input_common/drivers/udp_client.cpp
index 9780ead..869d88c 100755
--- a/src/input_common/drivers/udp_client.cpp
+++ b/src/input_common/drivers/udp_client.cpp
@@ -3,6 +3,7 @@
 // Refer to the license.txt file included.
 
 #include <random>
+#include <utility>
 #include <boost/asio.hpp>
 #include <fmt/format.h>
 
diff --git a/src/shader_recompiler/frontend/maxwell/control_flow.cpp b/src/shader_recompiler/frontend/maxwell/control_flow.cpp
index efe457b..d4bd315 100755
--- a/src/shader_recompiler/frontend/maxwell/control_flow.cpp
+++ b/src/shader_recompiler/frontend/maxwell/control_flow.cpp
@@ -16,6 +16,12 @@
 #include "shader_recompiler/frontend/maxwell/indirect_branch_table_track.h"
 #include "shader_recompiler/frontend/maxwell/location.h"
 
+#ifdef __GNUC__
+#ifndef __clang__
+#pragma GCC diagnostic ignored "-Wstringop-overread"
+#endif
+#endif
+
 namespace Shader::Maxwell::Flow {
 namespace {
 struct Compare {
diff --git a/src/shader_recompiler/ir_opt/verification_pass.cpp b/src/shader_recompiler/ir_opt/verification_pass.cpp
index 975d5aa..dcd9b8b 100755
--- a/src/shader_recompiler/ir_opt/verification_pass.cpp
+++ b/src/shader_recompiler/ir_opt/verification_pass.cpp
@@ -10,6 +10,12 @@
 #include "shader_recompiler/frontend/ir/value.h"
 #include "shader_recompiler/ir_opt/passes.h"
 
+#ifdef __GNUC__
+#ifndef __clang__
+#pragma GCC diagnostic ignored "-Wrange-loop-construct"
+#endif
+#endif
+
 namespace Shader::Optimization {
 
 static void ValidateTypes(const IR::Program& program) {
diff --git a/src/video_core/macro/macro_jit_x64.cpp b/src/video_core/macro/macro_jit_x64.cpp
index 47b28ad..ea1324d 100755
--- a/src/video_core/macro/macro_jit_x64.cpp
+++ b/src/video_core/macro/macro_jit_x64.cpp
@@ -18,6 +18,12 @@
 #include "video_core/macro/macro_interpreter.h"
 #include "video_core/macro/macro_jit_x64.h"
 
+#ifdef __GNUC__
+#ifndef __clang__
+#pragma GCC diagnostic ignored "-Warray-bounds"
+#endif
+#endif
+
 MICROPROFILE_DEFINE(MacroJitCompile, "GPU", "Compile macro JIT", MP_RGB(173, 255, 47));
 MICROPROFILE_DEFINE(MacroJitExecute, "GPU", "Execute macro JIT", MP_RGB(255, 255, 0));
 
-- 
2.35.1

