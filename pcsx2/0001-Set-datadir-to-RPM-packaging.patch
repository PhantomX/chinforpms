From 6e0d36b4b2ef4ffec912a6cadd4afcbb1339e706 Mon Sep 17 00:00:00 2001
From: Phantom X <PhantomX@users.noreply.github.com>
Date: Tue, 3 Jan 2023 18:40:09 -0300
Subject: [PATCH] Set datadir to RPM packaging

---
 pcsx2-qt/Translations.cpp | 6 +++---
 pcsx2/Pcsx2Config.cpp     | 2 +-
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/pcsx2-qt/Translations.cpp b/pcsx2-qt/Translations.cpp
index d8f1ca6..27be2b0 100644
--- a/pcsx2-qt/Translations.cpp
+++ b/pcsx2-qt/Translations.cpp
@@ -121,12 +121,12 @@ void QtHost::InstallTranslator(QWidget* dialog_parent)
 #ifdef __APPLE__
 	const QString base_dir = QStringLiteral("%1/../Resources/translations").arg(qApp->applicationDirPath());
 #else
-	const QString base_dir = QStringLiteral("%1/translations").arg(qApp->applicationDirPath());
+	const QString base_dir = QStringLiteral("_RPM_DATADIR_/translations");
 #endif
 
 	// Qt base uses underscores instead of hyphens.
 	const QString qt_language = QString(language).replace(QChar('-'), QChar('_'));
-	QString base_path = QStringLiteral("%1/qt_%2.qm").arg(base_dir).arg(qt_language);
+	QString base_path = QStringLiteral("_RPM_QTTDIR_/qt_%1.qm").arg(qt_language);
 	bool has_base_ts = QFile::exists(base_path);
 	if (!has_base_ts)
 	{
@@ -134,7 +134,7 @@ void QtHost::InstallTranslator(QWidget* dialog_parent)
 		const int index = language.lastIndexOf('-');
 		if (index > 0)
 		{
-			base_path = QStringLiteral("%1/qt_%2.qm").arg(base_dir).arg(language.left(index));
+			base_path = QStringLiteral("_RPM_QTTDIR_/qt_%1.qm").arg(language.left(index));
 			has_base_ts = QFile::exists(base_path);
 		}
 	}
diff --git a/pcsx2/Pcsx2Config.cpp b/pcsx2/Pcsx2Config.cpp
index 9a715c0..7e71aea 100644
--- a/pcsx2/Pcsx2Config.cpp
+++ b/pcsx2/Pcsx2Config.cpp
@@ -1882,7 +1882,7 @@ bool EmuFolders::SetResourcesDirectory()
 #ifndef __APPLE__  
 	#ifndef PCSX2_APP_DATADIR
 		// On Windows/Linux, these are in the binary directory.
-		Resources = Path::Combine(AppRoot, "resources");
+		Resources = "_RPM_DATADIR_/resources";
 	#else
 		Resources = Path::Canonicalize(Path::Combine(AppRoot, PCSX2_APP_DATADIR "/resources"));
 	#endif
-- 
2.46.0

