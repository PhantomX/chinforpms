From 902a844d6518614010d7410bec40c92949e0de30 Mon Sep 17 00:00:00 2001
From: Phantom X <PhantomX@users.noreply.github.com>
Date: Wed, 3 Aug 2022 22:19:34 -0300
Subject: [PATCH] system library support

---
 CMakeLists.txt                                  | 4 ++++
 Source/Core/VideoBackends/Vulkan/CMakeLists.txt | 4 ++--
 2 files changed, 6 insertions(+), 2 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index da1a9ee..812b8e2 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -666,6 +666,10 @@ if(ENABLE_VULKAN)
   if (ANDROID AND _M_ARM_64)
     add_subdirectory(Externals/libadrenotools)
   endif()
+
+  dolphin_find_optional_system_library(VulkanHeaders Externals/Vulkan-Headers 1.3.288)
+  dolphin_find_optional_system_library(VulkanMemoryAllocator Externals/VulkanMemoryAllocator)
+
 endif()
 
 if(NOT WIN32 OR (NOT (CMAKE_SYSTEM_PROCESSOR STREQUAL "aarch64")))
diff --git a/Source/Core/VideoBackends/Vulkan/CMakeLists.txt b/Source/Core/VideoBackends/Vulkan/CMakeLists.txt
index 5f5583f..dc8174b 100644
--- a/Source/Core/VideoBackends/Vulkan/CMakeLists.txt
+++ b/Source/Core/VideoBackends/Vulkan/CMakeLists.txt
@@ -44,6 +44,8 @@ PUBLIC
 
 PRIVATE
   xxhash::xxhash
+  Vulkan::Headers
+  GPUOpen::VulkanMemoryAllocator
 )
 
 if (ANDROID AND _M_ARM_64)
@@ -56,8 +58,6 @@ endif()
 # Only include the Vulkan headers when building the Vulkan backend
 target_include_directories(videovulkan
 PRIVATE
-  ${CMAKE_SOURCE_DIR}/Externals/Vulkan-Headers/include
-  ${CMAKE_SOURCE_DIR}/Externals/VulkanMemoryAllocator/include
   ${CMAKE_SOURCE_DIR}/Externals/libadrenotools/include
 )
 
-- 
2.51.1

