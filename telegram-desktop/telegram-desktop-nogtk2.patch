--- tdesktop-1.3.9/Telegram/gyp/telegram_linux.gypi.orig	2018-07-06 15:04:49.007781413 -0300
+++ tdesktop-1.3.9/Telegram/gyp/telegram_linux.gypi	2018-07-06 15:05:17.720734467 -0300
@@ -61,9 +61,8 @@
     'conditions': [
       ['not_need_gtk!="True"', {
         'cflags_cc': [
-          '<!(pkg-config 2> /dev/null --cflags appindicator-0.1)',
+          '<!(pkg-config 2> /dev/null --cflags appindicator3-0.1)',
           '<!(pkg-config 2> /dev/null --cflags gtk+-3.0)',
-          '<!(pkg-config 2> /dev/null --cflags dee-1.0)',
         ],
       }]
     ],
--- tdesktop-1.3.9/Telegram/SourceFiles/platform/linux/linux_libs.cpp.orig	2017-12-30 11:13:48.000000000 +0100
+++ tdesktop-1.3.9/Telegram/SourceFiles/platform/linux/linux_libs.cpp	2018-01-17 11:41:49.593275952 +0100
@@ -253,24 +253,12 @@
 			indicatorLoaded = setupAppIndicator(lib_indicator);
 		}
 	}
-	if (!gtkLoaded || !indicatorLoaded) {
-		if (loadLibrary(lib_indicator, "appindicator", 1)) {
-			if (loadLibrary(lib_gtk, "gtk-x11-2.0", 0)) {
-				gtkLoaded = indicatorLoaded = false;
-				gtkLoaded = setupGtkBase(lib_gtk);
-				indicatorLoaded = setupAppIndicator(lib_indicator);
-			}
-		}
-	}
 
 	// If no appindicator, try at least load gtk.
 	if (!gtkLoaded && !indicatorLoaded) {
 		if (loadLibrary(lib_gtk, "gtk-3", 0)) {
 			gtkLoaded = setupGtkBase(lib_gtk);
 		}
-		if (!gtkLoaded && loadLibrary(lib_gtk, "gtk-x11-2.0", 0)) {
-			gtkLoaded = setupGtkBase(lib_gtk);
-		}
 	}
 
 	if (gtkLoaded) {
