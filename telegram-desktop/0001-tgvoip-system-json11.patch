From 7feaaaa2b4be45680d1cdce4bd1a6bc1b4d20aa2 Mon Sep 17 00:00:00 2001
From: Phantom X <PhantomX@users.noreply.github.com>
Date: Mon, 17 Jan 2022 08:51:39 -0300
Subject: [PATCH] tgvoip: system json11

---
 Telegram/cmake/lib_tgvoip.cmake | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/Telegram/cmake/lib_tgvoip.cmake b/Telegram/cmake/lib_tgvoip.cmake
index 9b8ec54..4b462cc 100644
--- a/Telegram/cmake/lib_tgvoip.cmake
+++ b/Telegram/cmake/lib_tgvoip.cmake
@@ -72,8 +72,6 @@ PRIVATE
     video/VideoSource.h
     video/VideoRenderer.cpp
     video/VideoRenderer.h
-    json11.cpp
-    json11.hpp
 
     # Windows
     os/windows/NetworkSocketWinsock.cpp
@@ -182,6 +180,10 @@ PRIVATE
 )
 
 if (LINUX)
+    find_package(PkgConfig REQUIRED)
+    pkg_check_modules(JSON11 REQUIRED json11)
+    target_include_directories(lib_tgvoip_bundled PRIVATE ${JSON11_INCLUDE_DIRS})
+
     if (NOT LIBTGVOIP_DISABLE_ALSA)
         find_package(ALSA REQUIRED)
         target_include_directories(lib_tgvoip_bundled SYSTEM PRIVATE ${ALSA_INCLUDE_DIRS})
@@ -217,4 +219,5 @@ endif()
 target_link_libraries(lib_tgvoip
 INTERFACE
     lib_tgvoip_bundled
+    ${JSON11_LIBRARIES}
 )
-- 
2.34.1

