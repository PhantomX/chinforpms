From 43fce1f25cf4023ec66ecbe8e3a5e4f125e640ce Mon Sep 17 00:00:00 2001
From: Phantom X <PhantomX@users.noreply.github.com>
Date: Tue, 1 Feb 2022 11:27:21 -0300
Subject: [PATCH] Do not show unread counter on muted chats

---
 Telegram/SourceFiles/dialogs/ui/dialogs_layout.cpp | 14 ++++++++------
 1 file changed, 8 insertions(+), 6 deletions(-)

diff --git a/Telegram/SourceFiles/dialogs/ui/dialogs_layout.cpp b/Telegram/SourceFiles/dialogs/ui/dialogs_layout.cpp
index dd209de..76a8868 100644
--- a/Telegram/SourceFiles/dialogs/ui/dialogs_layout.cpp
+++ b/Telegram/SourceFiles/dialogs/ui/dialogs_layout.cpp
@@ -186,6 +186,7 @@ int PaintWideCounter(
 		st.active = active;
 		st.selected = selected;
 		st.muted = unreadMuted;
+		if (!st.muted) {
 		const auto badge = PaintUnreadBadge(
 			p,
 			counter,
@@ -193,6 +194,7 @@ int PaintWideCounter(
 			unreadTop,
 			st);
 		availableWidth -= badge.width() + st.padding;
+		}
 
 		hadOneBadge = true;
 	} else if (displayPinnedIcon) {
@@ -1109,12 +1111,12 @@ void PaintCollapsedRow(
 		const auto unreadRight = fullWidth - st::dialogsPadding.x();
 		UnreadBadgeStyle st;
 		st.muted = true;
-		PaintUnreadBadge(
-			p,
-			QString::number(unread),
-			unreadRight,
-			unreadTop,
-			st);
+//		PaintUnreadBadge(
+//			p,
+//			QString::number(unread),
+//			unreadRight,
+//			unreadTop,
+//			st);
 	}
 }
 
-- 
2.34.1

