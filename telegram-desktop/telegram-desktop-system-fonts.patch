From 02e7d276c955d73f7dae913813a4d4ede5af4b84 Mon Sep 17 00:00:00 2001
From: Phantom X <PhantomX@users.noreply.github.com>
Date: Wed, 8 Jan 2020 13:36:14 -0300
Subject: [PATCH] Use system fonts

Use packaged ones instead
---
 Telegram/lib_ui/fonts/fonts.qrc              |  8 --------
 Telegram/lib_ui/ui/style/style_core_font.cpp | 17 +++++++++--------
 2 files changed, 9 insertions(+), 16 deletions(-)

diff --git a/Telegram/lib_ui/fonts/fonts.qrc b/Telegram/lib_ui/fonts/fonts.qrc
index fb1208d..03585ec 100644
--- a/Telegram/lib_ui/fonts/fonts.qrc
+++ b/Telegram/lib_ui/fonts/fonts.qrc
@@ -1,10 +1,2 @@
 <RCC>
-  <qresource prefix="/gui/fonts">
-    <file>DAOpenSansRegular.ttf</file>
-    <file>DAOpenSansRegularItalic.ttf</file>
-    <file>DAOpenSansBold.ttf</file>
-    <file>DAOpenSansBoldItalic.ttf</file>
-    <file>DAOpenSansSemibold.ttf</file>
-    <file>DAOpenSansSemiboldItalic.ttf</file>
-  </qresource>
 </RCC>
diff --git a/Telegram/lib_ui/ui/style/style_core_font.cpp b/Telegram/lib_ui/ui/style/style_core_font.cpp
index cfe2111..84c9690 100644
--- a/Telegram/lib_ui/ui/style/style_core_font.cpp
+++ b/Telegram/lib_ui/ui/style/style_core_font.cpp
@@ -94,12 +94,12 @@ enum {
 	FontTypesCount,
 };
 QString FontTypeNames[FontTypesCount] = {
-	"DAOpenSansRegular",
-	"DAOpenSansRegularItalic",
-	"DAOpenSansBold",
-	"DAOpenSansBoldItalic",
-	"DAOpenSansSemibold",
-	"DAOpenSansSemiboldItalic",
+	"Open Sans",
+	"Open Sans",
+	"Open Sans",
+	"Open Sans",
+	"Open Sans Semibold",
+	"Open Sans Semibold",
 };
 int32 FontTypeFlags[FontTypesCount] = {
 	0,
@@ -135,8 +135,9 @@ void StartFonts() {
 	for (auto i = 0; i != FontTypesCount; ++i) {
 		const auto name = FontTypeNames[i];
 		const auto flags = FontTypeFlags[i];
-		areGood[i] = LoadCustomFont(":/gui/fonts/" + name + ".ttf", name, flags);
-		Overrides[i] = name;
+		if (ValidateFont(name, flags)) {
+			Overrides[i] = name;
+		}
 #ifdef Q_OS_WIN
 		// Attempt to workaround a strange font bug with Open Sans Semibold not loading.
 		// See https://github.com/telegramdesktop/tdesktop/issues/3276 for details.
-- 
2.24.1

