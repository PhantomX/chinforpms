From f0e7d1021d63ee3dbb66826bbdc7f10c62338760 Mon Sep 17 00:00:00 2001
From: Phantom X <PhantomX@users.noreply.github.com>
Date: Mon, 22 Aug 2022 22:53:43 -0300
Subject: [PATCH] Set datadir to RPM packaging

---
 src/duckstation-qt/qthost.cpp         | 2 +-
 src/duckstation-qt/qttranslations.cpp | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/src/duckstation-qt/qthost.cpp b/src/duckstation-qt/qthost.cpp
index c6aad17..08a45fb 100644
--- a/src/duckstation-qt/qthost.cpp
+++ b/src/duckstation-qt/qthost.cpp
@@ -237,7 +237,7 @@ void QtHost::SetResourcesDirectory()
 {
 #ifndef __APPLE__
   // On Windows/Linux, these are in the binary directory.
-  EmuFolders::Resources = Path::Combine(EmuFolders::AppRoot, "resources");
+  EmuFolders::Resources = "_RPM_DATADIR_/resources";
 #else
   // On macOS, this is in the bundle resources directory.
   EmuFolders::Resources = Path::Canonicalize(Path::Combine(EmuFolders::AppRoot, "../Resources"));
diff --git a/src/duckstation-qt/qttranslations.cpp b/src/duckstation-qt/qttranslations.cpp
index f0bbff8..c8c9839 100644
--- a/src/duckstation-qt/qttranslations.cpp
+++ b/src/duckstation-qt/qttranslations.cpp
@@ -38,8 +38,8 @@ void QtHost::InstallTranslator()
   const QString language(QString::fromStdString(Host::GetBaseStringSettingValue("Main", "Language", "en")));
 
   // install the base qt translation first
-  const QString base_dir(QStringLiteral("%1/translations").arg(qApp->applicationDirPath()));
-  QString base_path(QStringLiteral("%1/qtbase_%2.qm").arg(base_dir).arg(language));
+  const QString base_dir(QStringLiteral("_RPM_DATADIR_/translations"));
+  QString base_path(QStringLiteral("_RPM_QTTDIR_/qtbase_%1.qm").arg(language));
   bool has_base_ts = QFile::exists(base_path);
   if (!has_base_ts)
   {
-- 
2.37.2

