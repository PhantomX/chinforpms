From 8ad6f724115c8331a00c580c32ea348c865d36db Mon Sep 17 00:00:00 2001
From: Phantom X <PhantomX@users.noreply.github.com>
Date: Sun, 5 May 2024 23:10:47 -0300
Subject: [PATCH] cmake: discord-rpc switch

---
 dep/CMakeLists.txt      | 2 ++
 src/core/CMakeLists.txt | 2 +-
 2 files changed, 3 insertions(+), 1 deletion(-)

diff --git a/dep/CMakeLists.txt b/dep/CMakeLists.txt
index c21eb80..959b8a5 100644
--- a/dep/CMakeLists.txt
+++ b/dep/CMakeLists.txt
@@ -108,8 +108,10 @@ add_subdirectory(cubeb EXCLUDE_FROM_ALL)
 disable_compiler_warnings_for_target(cubeb)
 disable_compiler_warnings_for_target(speex)
 endif()
+if(ENABLE_DISCORD_PRESENCE)
 add_subdirectory(discord-rpc EXCLUDE_FROM_ALL)
 disable_compiler_warnings_for_target(discord-rpc)
+endif()
 add_subdirectory(kissfft EXCLUDE_FROM_ALL)
 disable_compiler_warnings_for_target(kissfft)
 add_subdirectory(freesurround EXCLUDE_FROM_ALL)
diff --git a/src/core/CMakeLists.txt b/src/core/CMakeLists.txt
index 4710da5..c11fa38 100644
--- a/src/core/CMakeLists.txt
+++ b/src/core/CMakeLists.txt
@@ -180,7 +180,7 @@ if(CPU_ARCH_RISCV64)
   message(STATUS "Building RISC-V 64-bit recompiler.")
 endif()
 
-if(NOT ANDROID)
+if(ENABLE_DISCORD_PRESENCE)
   target_compile_definitions(core PUBLIC -DENABLE_DISCORD_PRESENCE=1)
   target_link_libraries(core PRIVATE discord-rpc)
 endif()
-- 
2.45.0

